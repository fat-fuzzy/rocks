<script lang="ts">
	import {page} from '$app/state'
	import ui from '@fat-fuzzy/ui'
	import Footer from '$lib/ui/Footer.svelte'

	const {PageRails, Aside} = ui.content
	const {EscapeHtml} = ui.headless

	let markdown = $derived(
		page.data.markdowns.usages.find((d) => d.path === page.data.html.path),
	)
	let title = $derived(markdown.meta.title)
	let description = $derived(`Developer Doc ${markdown.meta.id}: ${title}`)
	// let updated = $derived(markdown.meta.date_created) TODO
	let html = $derived(markdown.html)
	let slug = $derived(markdown.meta.slug)
</script>

{#key title}
	<PageRails
		pageName="Usage"
		{title}
		{description}
		size="sm"
		path={page.url.pathname}
		nav={page.data.nav}
		context={page.data.context}
		layout=""
	>
		{#snippet main()}
			<EscapeHtml id={slug} {html} size="md" margin="auto" />
			<div class="l:text:md maki:auto">
				<Footer />
			</div>
		{/snippet}
		{#snippet aside()}
			<Aside
				created={markdown.meta.date_created}
				updated={markdown.meta.date_updated}
			/>
		{/snippet}
	</PageRails>
{/key}
