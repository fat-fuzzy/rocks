/**
 * Grid Rails Layout
 */

html:has(.l\:grid\:rails) {
	block-size: 100%;
	scroll-snap-type: y mandatory;
}

body:has(.l\:grid\:rails) {
	inline-size: 100vw;
	block-size: 100vh;
	margin: 0;
	padding: 0;
	overflow: hidden;
	scroll-snap-align: start;
	scroll-snap-stop: normal;
	scroll-padding-block-start: var(--ui-size);
}

.l\:grid\:rails {
	--side-track-width-viewport-sm: calc(100vw - 2 * var(--ui-size));
	position: relative;
	inline-size: 100vw;
	block-size: 100vh;
	gap: var(--outline-offset-lg);
	grid-template-areas:
		'main-header    main-header'
		'sidenav   			page-context'
		'page-main      page-main';
	grid-template-columns: minmax(50%, var(--sidebar-width)) minmax(
			50%,
			var(--sidebar-width)
		);
}

.l\:grid\:rails:has([class*='media:']) {
	grid-template-areas:
		'main-header    main-header'
		'sidenav   			page-context'
		'page-context   page-context'
		'page-main      page-main';
	grid-template-columns: auto 1fr;
}

.main-header {
	grid-area: main-header;
}

.sidenav {
	grid-area: sidenav;
	position: relative;
	inline-size: 100%;
	padding-block: var(--outline-offset-md);
	padding-inline: var(--ui-size) var(--outline-offset-lg);
	max-inline-size: var(--side-track-width-viewport-sm);
}

.sidenav > nav.expanded > ff-reveal {
	position: absolute;
	top: calc(var(--ui-header-height) - var(--outline-offset-lg));
	left: calc(var(--ui-size) + var(--outline-offset-lg));
	right: calc(2 * var(--outline-offset-lg));
	max-block-size: var(--overlay-height-xs);
	margin-block-start: 0;
	padding-block: var(--ui-size-sm);
	padding-inline: var(--ui-size-sm);
	box-shadow: var(--shadow-md);
	overflow: hidden auto;
	overscroll-behavior-y: contain;
	scrollbar-gutter: stable;
	scrollbar-width: thin;
	z-index: var(--layout-z-index-reveal);
}

.sidenav > nav > form {
	max-inline-size: 100%;
}

.sidenav > nav > form [aria-expanded] {
	inline-size: 100%;
}

.page-main {
	--lightness-scrollbar: var(--lightness-base);
	--chroma-scrollbar: var(--chroma-base);
	--track: oklch(var(--lightness-scrollbar) var(--chroma-scrollbar) var(--hue));
	--thumb: var(--ink);
	overflow: hidden auto;
	grid-area: page-main;
	scrollbar-gutter: stable;
	scrollbar-width: thin;
	scrollbar-color: var(--thumb) var(--track);
	block-size: 100%;
	padding-inline: var(--ui-size);
	padding-block-end: var(--ui-size);
}

.page-main > section {
	scroll-margin-block: var(--size-base-2xl);
}

.page-context {
	grid-area: page-context;
	position: relative;
	justify-self: end;
	inline-size: 100%;
	max-inline-size: var(--side-track-width-viewport-sm);
	padding-block: var(--outline-offset-md);
	padding-inline: var(--outline-offset-lg) var(--ui-size);
}

.page-context form:first-of-type [aria-expanded] {
	inline-size: 100%;
}

.page-context ff-reveal.expanded:first-of-type {
	--sidebar-width: var(--layout-sidebar-md);
	position: absolute;
	top: calc(var(--ui-header-height) - var(--outline-offset-lg));
	left: calc(2 * var(--outline-offset-lg));
	right: calc(var(--ui-size) + var(--outline-offset-lg));
	max-inline-size: var(--side-track-width-viewport-sm);
	max-block-size: var(--overlay-height-xs);
	margin-block-start: 0;
	padding-block: var(--ui-size-sm);
	padding-inline: var(--outline-offset-lg);
	box-shadow: var(--shadow-md);
	overflow: hidden auto;
	scrollbar-gutter: stable;
	scrollbar-width: thin;
	overscroll-behavior-y: contain;
	z-index: var(--layout-z-index-sticky);
}

.page-context[class*='media:'],
.page-context[class*='media:'] ff-reveal.expanded:first-of-type,
.page-context[class*='media:'] ff-reveal.collapsed:first-of-type {
	max-block-size: unset;
	box-shadow: none;
}

.page-context[class*='media:'] {
	max-block-size: unset;
}

@media screen and (min-width: 620px) {
	.l\:grid\:rails {
		grid-template-areas:
			'main-header   main-header'
			'sidenav  		 page-context'
			'page-main     page-context';
		grid-template-columns: 1fr auto;
	}

	.l\:grid\:rails:has([class*='media:']) {
		grid-template-areas:
			'main-header   main-header'
			'sidenav  		 page-context'
			'page-main     page-context';
		grid-template-columns: 1fr 1fr;
	}

	.page-main {
		min-block-size: calc(100vh - 6 * var(--ui-header-height));
		max-block-size: calc(100vh - 2 * var(--ui-header-height));
		padding-block-end: var(--ui-header-height);
	}

	.page-main footer {
		padding-block-end: var(--ui-header-height);
	}

	.sidenav > nav > form {
		inline-size: var(--sidebar-width);
	}

	ff-reveal:has(.header-nav) {
		box-shadow: unset;
		inline-size: calc(100vw - var(--sidebar-width));
		z-index: var(--layout-z-index-reveal);
		border-radius: var(--border-radius-null);
	}

	.header-nav {
		justify-content: flex-start;
	}

	.sidenav > nav.expanded > ff-reveal {
		inline-size: calc(100vw - 6 * var(--ui-size) - var(--sidebar-width));
		max-inline-size: calc(100% - 2 * var(--ui-size));
		z-index: var(--layout-z-index-reveal);
	}

	.page-context {
		overflow: hidden auto;
		overscroll-behavior-y: contain;
		scrollbar-gutter: stable;
		scrollbar-width: thin;
		inline-size: var(--sidebar-width);
		max-inline-size: 100%;
		block-size: fit-content;
		max-block-size: calc(100vh - var(--ui-header-height) - var(--ui-size));
		padding-inline: var(--outline-offset-lg) var(--ui-size);
		padding-block-end: var(--ui-header-height);
	}

	.page-context > .l\:reveal\:auto {
		inline-size: var(--sidebar-width);
	}

	.page-context > .l\:reveal\:auto > ff-reveal {
		inline-size: 100%;
		max-inline-size: var(--sidebar-width);
		padding-inline: var(--ui-size) 0;
	}

	.page-context ff-reveal.expanded:first-of-type {
		position: unset;
	}

	.page-context ff-reveal.expanded:first-of-type,
	.page-context ff-reveal.collapsed:first-of-type {
		margin-block-start: var(--outline-offset-lg);
		position: unset;
		block-size: fit-content;
		max-block-size: unset;
		inline-size: 100%;
		max-inline-size: var(--sidebar-width);
		box-shadow: unset;
		padding: 0;
	}

	.page-context[class*='media:'],
	.page-context[class*='media:'] ff-reveal.expanded:first-of-type,
	.page-context[class*='media:'] ff-reveal.collapsed:first-of-type {
		inline-size: 100%;
		max-inline-size: unset;
	}

	.page-context[class*='media:'] > .l\:reveal\:auto {
		inline-size: 100%;
	}
}

@media screen and (min-width: 935px) {
	.l\:grid\:rails {
		grid-template-areas:
			'main-header    main-header  main-header'
			'sidenav        page-main    page-context';
		grid-template-columns: auto 1fr auto;
	}

	.l\:grid\:rails:has([class*='media:']) {
		grid-template-areas:
			'main-header    main-header  main-header'
			'sidenav        page-main    page-context';
		grid-template-columns: auto 1fr 1fr;
	}

	.sidenav {
		inline-size: 100%;
		max-inline-size: unset;
		min-inline-size: var(--sidebar-width);
	}

	.sidenav > nav > ff-reveal {
		position: unset;
	}

	.sidenav > nav.expanded > form {
		inline-size: calc(
			var(--sidebar-width) - var(--ui-size) + var(--outline-offset-sm)
		);
	}

	.sidenav > nav > ff-reveal.expanded,
	.sidenav > nav > ff-reveal.collapsed {
		margin-block-start: var(--outline-offset-lg);
		position: unset;
		block-size: fit-content;
		max-block-size: calc(100vh - 2 * var(--ui-header-height));
		max-inline-size: var(--sidebar-width);
		box-shadow: unset;
		padding: 0;
	}

	.sidenav > nav.collapsed,
	.sidenav > nav > ff-reveal.collapsed {
		--sidebar-width: var(--layout-sidebar-collapsed);
		max-inline-size: var(--sidebar-width);
	}
}
